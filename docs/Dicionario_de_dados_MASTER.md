| markdown_output                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| # Dicionrio de Dados  Schema dashboard

Este documento  gerado automaticamente a partir do Supabase.
Representa o estado tcnico atual do schema `dashboard`.

---

## Tabelas

### agg_client_day\n\n| Column | Type | Nullable | Default |\n|--------|------|----------|---------|\n| id | uuid | NO | gen_random_uuid() |
| client_id | uuid | NO |  |
| data | date | NO |  |
| total_receita | numeric | YES |  |
| total_lucro | numeric | YES |  |
| margem_media | numeric | YES |  |
| total_vendas | numeric | YES |  |
| ticket_medio | numeric | YES |  |
| roas_medio | numeric | YES |  |
| cac_medio | numeric | YES |  |
| ltv_estimado | numeric | YES |  |
| estoque_total | numeric | YES |  |
| rupturas | integer | YES |  |
| reputacao_status | text | YES |  |
| reputacao_nivel | text | YES |  |
| gasto_ads | numeric | YES |  |
| impressoes | numeric | YES |  |
| cliques | numeric | YES |  |
| ctr_medio | numeric | YES |  |
| roas_ads | numeric | YES |  |
| raw | jsonb | YES |  |
| created_at | timestamp with time zone | YES | now() |
| updated_at | timestamp with time zone | YES | now() |\n
### api_tokens\n\n| Column | Type | Nullable | Default |\n|--------|------|----------|---------|\n| id | uuid | NO | gen_random_uuid() |
| client_id | uuid | NO |  |
| platform | text | NO |  |
| access_token | text | YES |  |
| refresh_token | text | YES |  |
| expires_at | timestamp with time zone | YES |  |
| status | text | YES | 'active'::text |
| created_at | timestamp with time zone | YES | now() |
| updated_at | timestamp with time zone | YES | now() |
| user_id | bigint | YES |  |
| ml_nickname | text | YES |  |
| ml_first_name | text | YES |  |
| ml_last_name | text | YES |  |
| ml_email | text | YES |  |
| ml_phone | text | YES |  |
| ml_seller_status | text | YES |  |
| ml_points | integer | YES |  |
| ml_site_id | text | YES |  |
| ml_perma_link | text | YES |  |
| ml_logo | text | YES |  |
| bling_company_id | integer | YES |  |
| bling_company_name | text | YES |  |
| bling_cnpj | text | YES |  |
| bling_email | text | YES |  |
| bling_telefone | text | YES |  |
| bling_endereco | text | YES |  |
| bling_inscricao_estadual | text | YES |  |
| bling_owner_name | text | YES |  |
| upseller_account_id | text | YES |  |
| upseller_account_name | text | YES |  |
| upseller_owner_email | text | YES |  |
| upseller_owner_phone | text | YES |  |
| upseller_store_url | text | YES |  |
| upseller_plan | text | YES |  |
| display_name | text | YES |  |\n
### clients\n\n| Column | Type | Nullable | Default |\n|--------|------|----------|---------|\n| id | uuid | NO | gen_random_uuid() |
| client_id | uuid | NO |  |
| user_id | bigint | NO |  |
| display_name | text | NO |  |
| tipo_cliente | text | NO |  |
| status | text | NO |  |
| created_at | timestamp with time zone | NO | now() |
| updated_at | timestamp with time zone | NO | now() |\n
### etl_status_codes\n\n| Column | Type | Nullable | Default |\n|--------|------|----------|---------|\n| status | text | NO |  |
| description | text | NO |  |\n
### fact_sku_day\n\n| Column | Type | Nullable | Default |\n|--------|------|----------|---------|\n| id | uuid | NO | gen_random_uuid() |
| client_id | uuid | NO |  |
| data | date | NO |  |
| sku | text | NO |  |
| origem_api | text | NO |  |
| item_id | text | YES |  |
| codigo_bling | text | YES |  |
| seller_custom_field | text | YES |  |
| seller_sku | text | YES |  |
| quantidade_vendida | numeric | YES |  |
| receita_bruta | numeric | YES |  |
| receita_liquida | numeric | YES |  |
| preco_unitario | numeric | YES |  |
| desconto | numeric | YES |  |
| custo_produto | numeric | YES |  |
| custo_frete | numeric | YES |  |
| custo_comissao | numeric | YES |  |
| custo_embalagem | numeric | YES |  |
| custo_operacional | numeric | YES |  |
| lucro | numeric | YES |  |
| margem | numeric | YES |  |
| roas | numeric | YES |  |
| cac | numeric | YES |  |
| ltv | numeric | YES |  |
| estoque | numeric | YES |  |
| estoque_virtual | numeric | YES |  |
| deposito_id | text | YES |  |
| reputacao_status | text | YES |  |
| reputacao_nivel | text | YES |  |
| custo_ads | numeric | YES |  |
| impressoes | numeric | YES |  |
| cliques | numeric | YES |  |
| ctr | numeric | YES |  |
| gasto_ads | numeric | YES |  |
| roas_ads | numeric | YES |  |
| campanha_id | text | YES |  |
| modalidade_envio | text | YES |  |
| prazo_previsto | text | YES |  |
| status_envio | text | YES |  |
| raw | jsonb | YES |  |
| created_at | timestamp with time zone | YES | now() |
| updated_at | timestamp with time zone | YES | now() |\n
### insight_cache\n\n| Column | Type | Nullable | Default |\n|--------|------|----------|---------|\n| id | uuid | NO | gen_random_uuid() |
| client_id | uuid | YES |  |
| prompt | text | NO |  |
| context | jsonb | YES |  |
| response | text | NO |  |
| hash | text | NO |  |
| expires_at | timestamp with time zone | NO |  |
| created_at | timestamp with time zone | YES | now() |
| updated_at | timestamp with time zone | YES | now() |\n
### raw_events\n\n| Column | Type | Nullable | Default |\n|--------|------|----------|---------|\n| id | uuid | NO | gen_random_uuid() |
| client_id | uuid | NO |  |
| origem_api | text | NO |  |
| event_type | text | NO |  |
| payload | jsonb | NO |  |
| received_at | timestamp with time zone | YES | now() |\n
### updates_log\n\n| Column | Type | Nullable | Default |\n|--------|------|----------|---------|\n| id | uuid | NO | gen_random_uuid() |
| job_name | text | NO |  |
| status | text | NO |  |
| event | text | YES |  |
| details | jsonb | YES |  |
| duration_ms | integer | YES |  |
| created_at | timestamp with time zone | YES | now() |
| platform | text | YES |  |
| started_at | timestamp with time zone | YES |  |
| finished_at | timestamp with time zone | YES |  |
| notes | jsonb | YES |  |\n

---

## Views

### vw_ads_metrics\n\n| Column | Type | Nullable | Default |\n|--------|------|----------|---------|\n| client_id | uuid | YES |  |
| data | date | YES |  |
| gasto_ads_total | numeric | YES |  |
| impressoes_total | numeric | YES |  |
| cliques_total | numeric | YES |  |
| ctr_total | numeric | YES |  |
| roas_total | numeric | YES |  |
| clients_id | uuid | YES |  |
| clients_user_id | bigint | YES |  |
| clients_display_name | text | YES |  |
| clients_tipo_cliente | text | YES |  |
| clients_status | text | YES |  |\n\n**Definition:**\n\n```sql\n SELECT a.client_id,
    a.data,
    sum(a.gasto_ads) AS gasto_ads_total,
    sum(a.impressoes) AS impressoes_total,
    sum(a.cliques) AS cliques_total,
    sum(a.cliques) / NULLIF(sum(a.impressoes), 0::numeric) AS ctr_total,
    sum(a.receita_liquida) / NULLIF(sum(a.gasto_ads), 0::numeric) AS roas_total,
    c.id AS clients_id,
    c.user_id AS clients_user_id,
    c.display_name AS clients_display_name,
    c.tipo_cliente AS clients_tipo_cliente,
    c.status AS clients_status
   FROM fact_sku_day a
     JOIN clients c ON c.client_id = a.client_id
  GROUP BY a.client_id, a.data, c.id, c.user_id, c.display_name, c.tipo_cliente, c.status;\n```\n
### vw_client_snapshot\n\n| Column | Type | Nullable | Default |\n|--------|------|----------|---------|\n| id | uuid | YES |  |
| client_id | uuid | YES |  |
| data | date | YES |  |
| total_receita | numeric | YES |  |
| total_lucro | numeric | YES |  |
| margem_media | numeric | YES |  |
| total_vendas | numeric | YES |  |
| ticket_medio | numeric | YES |  |
| roas_medio | numeric | YES |  |
| cac_medio | numeric | YES |  |
| ltv_estimado | numeric | YES |  |
| estoque_total | numeric | YES |  |
| rupturas | integer | YES |  |
| reputacao_status | text | YES |  |
| reputacao_nivel | text | YES |  |
| gasto_ads | numeric | YES |  |
| impressoes | numeric | YES |  |
| cliques | numeric | YES |  |
| ctr_medio | numeric | YES |  |
| roas_ads | numeric | YES |  |
| created_at | timestamp with time zone | YES |  |
| updated_at | timestamp with time zone | YES |  |
| clients_id | uuid | YES |  |
| clients_user_id | bigint | YES |  |
| clients_display_name | text | YES |  |
| clients_tipo_cliente | text | YES |  |
| clients_status | text | YES |  |\n\n**Definition:**\n\n```sql\n SELECT a.id,
    a.client_id,
    a.data,
    a.total_receita,
    a.total_lucro,
    a.margem_media,
    a.total_vendas,
    a.ticket_medio,
    a.roas_medio,
    a.cac_medio,
    a.ltv_estimado,
    a.estoque_total,
    a.rupturas,
    a.reputacao_status,
    a.reputacao_nivel,
    a.gasto_ads,
    a.impressoes,
    a.cliques,
    a.ctr_medio,
    a.roas_ads,
    a.created_at,
    a.updated_at,
    c.id AS clients_id,
    c.user_id AS clients_user_id,
    c.display_name AS clients_display_name,
    c.tipo_cliente AS clients_tipo_cliente,
    c.status AS clients_status
   FROM agg_client_day a
     JOIN clients c ON c.client_id = a.client_id;\n```\n
### vw_clientes\n\n| Column | Type | Nullable | Default |\n|--------|------|----------|---------|\n| id | uuid | YES |  |
| client_id | uuid | YES |  |
| user_id | bigint | YES |  |
| display_name | text | YES |  |
| tipo_cliente | text | YES |  |
| status | text | YES |  |
| created_at | timestamp with time zone | YES |  |
| updated_at | timestamp with time zone | YES |  |
| has_mercado_livre | boolean | YES |  |
| has_bling | boolean | YES |  |
| has_upseller | boolean | YES |  |\n\n**Definition:**\n\n```sql\n SELECT c.id,
    c.client_id,
    c.user_id,
    c.display_name,
    c.tipo_cliente,
    c.status,
    c.created_at,
    c.updated_at,
    bool_or(t.platform = 'mercado_livre'::text AND t.status = 'active'::text) AS has_mercado_livre,
    bool_or(t.platform = 'bling'::text AND t.status = 'active'::text) AS has_bling,
    bool_or(t.platform = 'upseller'::text AND t.status = 'active'::text) AS has_upseller
   FROM clients c
     LEFT JOIN api_tokens t ON t.client_id = c.client_id
  GROUP BY c.id, c.client_id, c.user_id, c.display_name, c.tipo_cliente, c.status, c.created_at, c.updated_at;\n```\n
### vw_clientes_com_status\n\n| Column | Type | Nullable | Default |\n|--------|------|----------|---------|\n| client_id | uuid | YES |  |
| display_name | text | YES |  |
| data | date | YES |  |
| status_financeiro | text | YES |  |
| status_operacional | text | YES |  |
| status_ads | text | YES |  |
| status_reputacao | text | YES |  |
| margem_media | numeric | YES |  |
| total_lucro | numeric | YES |  |
| estoque_total | numeric | YES |  |
| rupturas | integer | YES |  |
| roas_ads | numeric | YES |  |
| reputacao_nivel | text | YES |  |\n\n**Definition:**\n\n```sql\n SELECT c.client_id,
    c.display_name,
    a.data,
        CASE
            WHEN a.margem_media >= 20::numeric THEN 'verde'::text
            WHEN a.margem_media >= 10::numeric THEN 'amarelo'::text
            ELSE 'vermelho'::text
        END AS status_financeiro,
        CASE
            WHEN a.rupturas > 0 THEN 'vermelho'::text
            WHEN a.estoque_total < 5::numeric THEN 'amarelo'::text
            ELSE 'verde'::text
        END AS status_operacional,
        CASE
            WHEN a.roas_ads >= 3::numeric THEN 'verde'::text
            WHEN a.roas_ads >= 1::numeric THEN 'amarelo'::text
            ELSE 'vermelho'::text
        END AS status_ads,
    a.reputacao_status AS status_reputacao,
    a.margem_media,
    a.total_lucro,
    a.estoque_total,
    a.rupturas,
    a.roas_ads,
    a.reputacao_nivel
   FROM vw_client_snapshot a
     JOIN clients c ON c.client_id = a.client_id;\n```\n
### vw_clientes_integracao\n\n| Column | Type | Nullable | Default |\n|--------|------|----------|---------|\n| client_id | uuid | YES |  |
| display_name | text | YES |  |
| platform | text | YES |  |
| status | text | YES |  |
| expires_at | timestamp with time zone | YES |  |
| dias_restantes_token | integer | YES |  |
| created_at | timestamp with time zone | YES |  |
| updated_at | timestamp with time zone | YES |  |\n\n**Definition:**\n\n```sql\n SELECT c.client_id,
    c.display_name,
    t.platform,
    t.status,
    t.expires_at,
    t.expires_at::date - now()::date AS dias_restantes_token,
    t.created_at,
    t.updated_at
   FROM api_tokens t
     JOIN clients c ON c.client_id = t.client_id;\n```\n
### vw_dashboard_overview_atual\n\n| Column | Type | Nullable | Default |\n|--------|------|----------|---------|\n| client_id | uuid | YES |  |
| display_name | text | YES |  |
| data | date | YES |  |
| total_receita | numeric | YES |  |
| total_lucro | numeric | YES |  |
| margem_media | numeric | YES |  |
| total_vendas | numeric | YES |  |
| roas_medio | numeric | YES |  |
| roas_ads | numeric | YES |  |
| estoque_total | numeric | YES |  |
| rupturas | integer | YES |  |
| reputacao_status | text | YES |  |
| reputacao_nivel | text | YES |  |
| status_financeiro | text | YES |  |
| status_operacional | text | YES |  |
| status_ads | text | YES |  |
| status_reputacao | text | YES |  |\n\n**Definition:**\n\n```sql\n WITH ultimos AS (
         SELECT vw_dashboard_overview_diario.client_id,
            max(vw_dashboard_overview_diario.data) AS data_recente
           FROM vw_dashboard_overview_diario
          GROUP BY vw_dashboard_overview_diario.client_id
        )
 SELECT d.client_id,
    d.display_name,
    d.data,
    d.total_receita,
    d.total_lucro,
    d.margem_media,
    d.total_vendas,
    d.roas_medio,
    d.roas_ads,
    d.estoque_total,
    d.rupturas,
    d.reputacao_status,
    d.reputacao_nivel,
    d.status_financeiro,
    d.status_operacional,
    d.status_ads,
    d.status_reputacao
   FROM vw_dashboard_overview_diario d
     JOIN ultimos u ON u.client_id = d.client_id AND u.data_recente = d.data;\n```\n
### vw_dashboard_overview_diario\n\n| Column | Type | Nullable | Default |\n|--------|------|----------|---------|\n| client_id | uuid | YES |  |
| display_name | text | YES |  |
| data | date | YES |  |
| total_receita | numeric | YES |  |
| total_lucro | numeric | YES |  |
| margem_media | numeric | YES |  |
| total_vendas | numeric | YES |  |
| roas_medio | numeric | YES |  |
| roas_ads | numeric | YES |  |
| estoque_total | numeric | YES |  |
| rupturas | integer | YES |  |
| reputacao_status | text | YES |  |
| reputacao_nivel | text | YES |  |
| status_financeiro | text | YES |  |
| status_operacional | text | YES |  |
| status_ads | text | YES |  |
| status_reputacao | text | YES |  |\n\n**Definition:**\n\n```sql\n SELECT snap.client_id,
    stat.display_name,
    snap.data,
    snap.total_receita,
    snap.total_lucro,
    snap.margem_media,
    snap.total_vendas,
    snap.roas_medio,
    snap.roas_ads,
    snap.estoque_total,
    snap.rupturas,
    snap.reputacao_status,
    snap.reputacao_nivel,
    stat.status_financeiro,
    stat.status_operacional,
    stat.status_ads,
    stat.status_reputacao
   FROM vw_client_snapshot snap
     JOIN vw_clientes_com_status stat ON stat.client_id = snap.client_id AND stat.data = snap.data;\n```\n
### vw_detalhes_sku\n\n| Column | Type | Nullable | Default |\n|--------|------|----------|---------|\n| client_id | uuid | YES |  |
| sku | text | YES |  |
| data | date | YES |  |
| receita_liquida | numeric | YES |  |
| lucro | numeric | YES |  |
| margem | numeric | YES |  |
| quantidade_vendida | numeric | YES |  |
| estoque | numeric | YES |  |
| estoque_virtual | numeric | YES |  |
| custo_produto | numeric | YES |  |
| custo_frete | numeric | YES |  |
| custo_comissao | numeric | YES |  |
| custo_ads | numeric | YES |  |
| roas_ads | numeric | YES |  |
| campanha_id | text | YES |  |
| reputacao_status | text | YES |  |
| reputacao_nivel | text | YES |  |
| clients_id | uuid | YES |  |
| clients_user_id | bigint | YES |  |
| clients_display_name | text | YES |  |
| clients_tipo_cliente | text | YES |  |
| clients_status | text | YES |  |\n\n**Definition:**\n\n```sql\n SELECT a.client_id,
    a.sku,
    a.data,
    a.receita_liquida,
    a.lucro,
    a.margem,
    a.quantidade_vendida,
    a.estoque,
    a.estoque_virtual,
    a.custo_produto,
    a.custo_frete,
    a.custo_comissao,
    a.custo_ads,
    a.roas_ads,
    a.campanha_id,
    a.reputacao_status,
    a.reputacao_nivel,
    c.id AS clients_id,
    c.user_id AS clients_user_id,
    c.display_name AS clients_display_name,
    c.tipo_cliente AS clients_tipo_cliente,
    c.status AS clients_status
   FROM fact_sku_day a
     JOIN clients c ON c.client_id = a.client_id;\n```\n
### vw_financeiro\n\n| Column | Type | Nullable | Default |\n|--------|------|----------|---------|\n| client_id | uuid | YES |  |
| data | date | YES |  |
| receita_total | numeric | YES |  |
| lucro_total | numeric | YES |  |
| margem_media | numeric | YES |  |
| custo_total | numeric | YES |  |
| unidades_vendidas | numeric | YES |  |
| clients_id | uuid | YES |  |
| clients_user_id | bigint | YES |  |
| clients_display_name | text | YES |  |
| clients_tipo_cliente | text | YES |  |
| clients_status | text | YES |  |\n\n**Definition:**\n\n```sql\n SELECT a.client_id,
    a.data,
    sum(a.receita_liquida) AS receita_total,
    sum(a.lucro) AS lucro_total,
    avg(a.margem) AS margem_media,
    sum(a.custo_produto + a.custo_frete + a.custo_comissao + a.custo_embalagem + a.custo_operacional) AS custo_total,
    sum(a.quantidade_vendida) AS unidades_vendidas,
    c.id AS clients_id,
    c.user_id AS clients_user_id,
    c.display_name AS clients_display_name,
    c.tipo_cliente AS clients_tipo_cliente,
    c.status AS clients_status
   FROM fact_sku_day a
     JOIN clients c ON c.client_id = a.client_id
  GROUP BY a.client_id, a.data, c.id, c.user_id, c.display_name, c.tipo_cliente, c.status;\n```\n
### vw_logs_etl\n\n| Column | Type | Nullable | Default |\n|--------|------|----------|---------|\n| id | uuid | YES |  |
| job_name | text | YES |  |
| status | text | YES |  |
| platform | text | YES |  |
| event | text | YES |  |
| started_at | timestamp with time zone | YES |  |
| finished_at | timestamp with time zone | YES |  |
| duration_ms | integer | YES |  |
| duration_interval | interval | YES |  |
| details | jsonb | YES |  |
| notes | jsonb | YES |  |
| created_at | timestamp with time zone | YES |  |\n\n**Definition:**\n\n```sql\n SELECT id,
    job_name,
    status,
    platform,
    event,
    started_at,
    finished_at,
    duration_ms,
    finished_at - started_at AS duration_interval,
    details,
    notes,
    created_at
   FROM updates_log
  ORDER BY created_at DESC;\n```\n
### vw_ml_category_day\n\n| Column | Type | Nullable | Default |\n|--------|------|----------|---------|\n| category_id | text | YES |  |
| data | date | YES |  |
| receita_bruta | numeric | YES |  |
| unidades_vendidas | numeric | YES |  |
| pedidos | bigint | YES |  |\n\n**Definition:**\n\n```sql\n SELECT category_id,
    data,
    sum(receita_bruta) AS receita_bruta,
    sum(quantidade_vendida) AS unidades_vendidas,
    count(DISTINCT order_id) AS pedidos
   FROM vw_ml_order_items_flat
  GROUP BY category_id, data;\n```\n
### vw_ml_client_day_enriched\n\n| Column | Type | Nullable | Default |\n|--------|------|----------|---------|\n| client_id | uuid | YES |  |
| data | date | YES |  |
| receita_bruta | numeric | YES |  |
| unidades_vendidas | numeric | YES |  |
| pedidos | bigint | YES |  |
| ticket_medio | numeric | YES |  |\n\n**Definition:**\n\n```sql\n SELECT client_id,
    data,
    sum(receita_bruta) AS receita_bruta,
    sum(quantidade_vendida) AS unidades_vendidas,
    count(DISTINCT order_id) AS pedidos,
        CASE
            WHEN count(DISTINCT order_id) > 0 THEN sum(receita_bruta) / count(DISTINCT order_id)::numeric
            ELSE NULL::numeric
        END AS ticket_medio
   FROM vw_ml_order_items_flat
  GROUP BY client_id, data;\n```\n
### vw_ml_order_items_flat\n\n| Column | Type | Nullable | Default |\n|--------|------|----------|---------|\n| client_id | uuid | YES |  |
| data | date | YES |  |
| order_id | text | YES |  |
| order_status | text | YES |  |
| sku | text | YES |  |
| product_title | text | YES |  |
| category_id | text | YES |  |
| seller_sku | text | YES |  |
| seller_custom_field | text | YES |  |
| quantidade_vendida | numeric | YES |  |
| preco_unitario | numeric | YES |  |
| receita_bruta | numeric | YES |  |
| custo_comissao_ml | numeric | YES |  |
| received_at | timestamp with time zone | YES |  |\n\n**Definition:**\n\n```sql\n SELECT re.client_id,
    (o.value ->> 'date_created'::text)::date AS data,
    o.value ->> 'id'::text AS order_id,
    o.value ->> 'status'::text AS order_status,
    (i.value -> 'item'::text) ->> 'id'::text AS sku,
    (i.value -> 'item'::text) ->> 'title'::text AS product_title,
    (i.value -> 'item'::text) ->> 'category_id'::text AS category_id,
    (i.value -> 'item'::text) ->> 'seller_sku'::text AS seller_sku,
    (i.value -> 'item'::text) ->> 'seller_custom_field'::text AS seller_custom_field,
    (i.value ->> 'quantity'::text)::numeric AS quantidade_vendida,
    (i.value ->> 'unit_price'::text)::numeric AS preco_unitario,
    ((i.value ->> 'quantity'::text)::numeric) * ((i.value ->> 'unit_price'::text)::numeric) AS receita_bruta,
    (i.value ->> 'sale_fee'::text)::numeric AS custo_comissao_ml,
    re.received_at
   FROM raw_events re
     CROSS JOIN LATERAL jsonb_array_elements(re.payload -> 'results'::text) o(value)
     CROSS JOIN LATERAL jsonb_array_elements(o.value -> 'order_items'::text) i(value)
  WHERE re.origem_api = 'mercado_livre'::text AND re.event_type = 'orders'::text;\n```\n
### vw_ml_top_skus\n\n| Column | Type | Nullable | Default |\n|--------|------|----------|---------|\n| sku | text | YES |  |
| product_title | text | YES |  |
| category_id | text | YES |  |
| unidades_vendidas | numeric | YES |  |
| receita_bruta | numeric | YES |  |\n\n**Definition:**\n\n```sql\n SELECT sku,
    product_title,
    category_id,
    sum(quantidade_vendida) AS unidades_vendidas,
    sum(receita_bruta) AS receita_bruta
   FROM vw_ml_order_items_flat
  GROUP BY sku, product_title, category_id
  ORDER BY (sum(quantidade_vendida)) DESC;\n```\n
### vw_ml_viang_day\n\n| Column | Type | Nullable | Default |\n|--------|------|----------|---------|\n| data | date | YES |  |
| receita_bruta_total | numeric | YES |  |
| unidades_totais | numeric | YES |  |
| pedidos_totais | numeric | YES |  |
| ticket_medio_geral | numeric | YES |  |\n\n**Definition:**\n\n```sql\n SELECT data,
    sum(receita_bruta) AS receita_bruta_total,
    sum(unidades_vendidas) AS unidades_totais,
    sum(pedidos) AS pedidos_totais,
        CASE
            WHEN sum(pedidos) > 0::numeric THEN sum(receita_bruta) / sum(pedidos)
            ELSE NULL::numeric
        END AS ticket_medio_geral
   FROM vw_ml_client_day_enriched
  GROUP BY data;\n```\n
### vw_produto_performance\n\n| Column | Type | Nullable | Default |\n|--------|------|----------|---------|\n| id | uuid | YES |  |
| client_id | uuid | YES |  |
| data | date | YES |  |
| sku | text | YES |  |
| origem_api | text | YES |  |
| item_id | text | YES |  |
| codigo_bling | text | YES |  |
| seller_custom_field | text | YES |  |
| seller_sku | text | YES |  |
| quantidade_vendida | numeric | YES |  |
| receita_bruta | numeric | YES |  |
| receita_liquida | numeric | YES |  |
| preco_unitario | numeric | YES |  |
| desconto | numeric | YES |  |
| custo_produto | numeric | YES |  |
| custo_frete | numeric | YES |  |
| custo_comissao | numeric | YES |  |
| custo_embalagem | numeric | YES |  |
| custo_operacional | numeric | YES |  |
| lucro | numeric | YES |  |
| margem | numeric | YES |  |
| roas | numeric | YES |  |
| cac | numeric | YES |  |
| ltv | numeric | YES |  |
| estoque | numeric | YES |  |
| estoque_virtual | numeric | YES |  |
| deposito_id | text | YES |  |
| reputacao_status | text | YES |  |
| reputacao_nivel | text | YES |  |
| custo_ads | numeric | YES |  |
| impressoes | numeric | YES |  |
| cliques | numeric | YES |  |
| ctr | numeric | YES |  |
| gasto_ads | numeric | YES |  |
| roas_ads | numeric | YES |  |
| campanha_id | text | YES |  |
| modalidade_envio | text | YES |  |
| prazo_previsto | text | YES |  |
| status_envio | text | YES |  |
| raw | jsonb | YES |  |
| created_at | timestamp with time zone | YES |  |
| updated_at | timestamp with time zone | YES |  |
| clients_id | uuid | YES |  |
| clients_user_id | bigint | YES |  |
| clients_display_name | text | YES |  |
| clients_tipo_cliente | text | YES |  |
| clients_status | text | YES |  |\n\n**Definition:**\n\n```sql\n SELECT a.id,
    a.client_id,
    a.data,
    a.sku,
    a.origem_api,
    a.item_id,
    a.codigo_bling,
    a.seller_custom_field,
    a.seller_sku,
    a.quantidade_vendida,
    a.receita_bruta,
    a.receita_liquida,
    a.preco_unitario,
    a.desconto,
    a.custo_produto,
    a.custo_frete,
    a.custo_comissao,
    a.custo_embalagem,
    a.custo_operacional,
    a.lucro,
    a.margem,
    a.roas,
    a.cac,
    a.ltv,
    a.estoque,
    a.estoque_virtual,
    a.deposito_id,
    a.reputacao_status,
    a.reputacao_nivel,
    a.custo_ads,
    a.impressoes,
    a.cliques,
    a.ctr,
    a.gasto_ads,
    a.roas_ads,
    a.campanha_id,
    a.modalidade_envio,
    a.prazo_previsto,
    a.status_envio,
    a.raw,
    a.created_at,
    a.updated_at,
    c.id AS clients_id,
    c.user_id AS clients_user_id,
    c.display_name AS clients_display_name,
    c.tipo_cliente AS clients_tipo_cliente,
    c.status AS clients_status
   FROM fact_sku_day a
     JOIN clients c ON c.client_id = a.client_id;\n```\n
 |